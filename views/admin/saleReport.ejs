<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Category</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/admin/addCategory.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
 
   
    
    body {
        overflow: auto;
    }
    
    .main-content {
        overflow-y: auto;
        max-height: 100vh;    }
    
    .main-content::-webkit-scrollbar {
        display: block; 
    }
    
    .sidebar {
        width: 250px;
        min-width: 250px;
    }
</style>
</head>

<body class="bg-gray-900">
    <div class="flex min-h-screen">
        
        <div class="sidebar">
            <div class="admin-profile">
                <div class="admin-avatar">A</div>
            </div>
            <ul class="nav-menu">
                <a href="/admin/dashboard" class="nav-item">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
                <a href="/admin/product" class="nav-item">
                    <i class="fas fa-box"></i>
                    <span>Products</span>
                </a>
                <a href="/admin/customer" class="nav-item">
                    <i class="fas fa-users"></i>
                    <span>Users</span>
                </a>
                <a href="/admin/category" class="nav-item">
                    <i class="fas fa-folder-open"></i>
                    <span>Categories</span>
                </a>
                <a href="/admin/orderlists" class="nav-item">
                    <i class="fas fa-shopping-cart"></i>
                    <span>Orders</span>
                </a>
                <a href="/admin/coupon" class="nav-item ">
                    <i class="fas fa-tags"></i>
                    <span>Coupons</span>
                </a>
                <a href="/admin/salesreport" class="nav-item active">
                    <i class="fas fa-chart-line"></i>
                    <span>Sales</span>
                </a>
                <a href="/admin/offer" class="nav-item">
                    <i class="fas fa-gift"></i>
                    <span>Offer</span>
                </a>
            </ul>
        </div>
        </div>

        <div class="main-content">
            <div class="header">
                <h1>RevGear</h1>
                <a href="/admin/dashboard" id="adminlogout">Back</a>
            </div>
            <br>
        <div class="container ml-3 mx-auto">
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div>
                    <h4 class="text-lg font-semibold mb-2 text-white">Generate Custom Date Report</h4>
                    <form action="/admin/customDateReport" method="GET" class="border p-4 rounded-lg bg-gray-800 shadow-md">
                        <div class="mb-4">
                            <label for="startDate" class="block text-sm font-medium text-gray-300">Start Date</label>
                            <input 
                                type="date" 
                                class="mt-1 block w-full rounded-md border-gray-600 bg-gray-700 text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" 
                                id="startDate" 
                                name="startDate" 
                                max="{{ new Date().toISOString().split('T')[0] }}" 
                                required>
                        </div>
                        <div class="mb-4">
                            <label for="endDate" class="block text-sm font-medium text-gray-300">End Date</label>
                            <input 
                                type="date" 
                                class="mt-1 block w-full rounded-md border-gray-600 bg-gray-700 text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" 
                                id="endDate" 
                                name="endDate" 
                                max="{{ new Date().toISOString().split('T')[0] }}" 
                                required>
                        </div>
                        <button type="submit" class="w-full bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600">Generate Report</button>
                    </form>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-2 text-white">Quick Filters</h4>
                    <div class="flex flex-col gap-2 border p-4 rounded-lg bg-gray-800 shadow-md">
                        <a href="/admin/salesDaily" class="btn bg-blue-700 text-white py-2 px-4 rounded hover:bg-blue-800">Daily Report</a>
                        <a href="/admin/salesWeekly" class="btn bg-blue-700 text-white py-2 px-4 rounded hover:bg-blue-800">Weekly Report</a>
                        <a href="/admin/salesMonthly" class="btn bg-blue-700 text-white py-2 px-4 rounded hover:bg-blue-800">Monthly Report</a>
                        <a href="/admin/salesYearly" class="btn bg-blue-700 text-white py-2 px-4 rounded hover:bg-blue-800">Yearly Report</a>
                    </div>
                </div>
            </div>
        
          
            <div class="card mb-4 border rounded-lg bg-gray-800 shadow-md">
                <header class="border-b p-4">
                    <h4 class="text-lg font-semibold text-white">Sales Report</h4>
                </header>
                <div class="p-4">
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-700">
                            <thead class="bg-gray-700">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">ID</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Order Number</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Order Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Date</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Customer</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">Total Price</th>
                                </tr>
                            </thead>
                            <tbody class="bg-gray-800 divide-y divide-gray-700">
                                <% for (let i = 0; i < orderDetails.length; i++) { %>
                                    <% const order = orderDetails[i]; %>
                                    <tr>
                                        <td class="px-6 py-4 text-gray-300"><%= i + 1 %></td>
                                        <td class="px-6 py-4 text-green-400"><%= order._id %></td>
                                        <td class="px-6 py-4" style="color: 
                                            <% if (order.orderStatus === 'Cancelled') { %> red; 
                                            <% } else if (order.orderStatus === 'Ordered') { %> orange; 
                                            <% } else if (order.orderStatus === 'Delivered') { %> green; 
                                            <% } else { %> gray; <% } %>">
                                            <%= order.orderStatus %>
                                        </td>
                                        <td class="px-6 py-4 text-gray-300"><%= new Date(order.orderDate).toLocaleDateString() %></td>
                                        <td class="px-6 py-4 text-gray-300"><%= order.deliveryAddress?.name || 'N/A' %></td>
                                        <td class="px-6 py-4 text-gray-300">â‚¹<%= order.totalAmount.toFixed(2) %></td>
                                    </tr>
                                <% } %>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        
            
            <div class="mt-4 flex justify-center">
                <nav>
                    <ul class="inline-flex space-x-2">
                        <% if (currentPage > 1) { %>
                            <li>
                                <a class="px-3 py-2 border rounded bg-gray-700 text-gray-300 hover:bg-gray-600" href="?page=<%= currentPage - 1 %>">Previous</a>
                            </li>
                        <% } %>
                        <% for (let i = 1; i <= totalPages; i++) { %>
                            <li>
                                <a class="px-3 py-2 border rounded <%= i === currentPage ? 'bg-blue-500 text-white' : 'bg-gray-700 text-gray-300' %> hover:bg-gray-600" href="?page=<%= i %>"><%= i %></a>
                            </li>
                        <% } %>
                        <% if (currentPage < totalPages) { %>
                            <li>
                                <a class="px-3 py-2 border rounded bg-gray-700 text-gray-300 hover:bg-gray-600" href="?page=<%= currentPage + 1 %>">Next</a>
                            </li>
                        <% } %>
                    </ul>
                </nav>
            </div>
        </div>
        
        <script>
            document.addEventListener('DOMContentLoaded', () => {
                const form = document.querySelector('form');
                const startDateInput = document.getElementById('startDate');
                const endDateInput = document.getElementById('endDate');
        
                // Set the maximum date to today for both inputs
                const today = new Date().toISOString().split('T')[0];
                startDateInput.setAttribute('max', today);
                endDateInput.setAttribute('max', today);
        
                form.addEventListener('submit', (event) => {
                    // Get selected dates
                    const startDate = new Date(startDateInput.value);
                    const endDate = new Date(endDateInput.value);
        
                    // Check if dates are valid
                    if (!startDateInput.value || !endDateInput.value || isNaN(startDate.getTime()) || isNaN(endDate.getTime())) {
                        event.preventDefault();
                        Swal.fire({
                            icon: 'error',
                            title: 'Invalid Date Format',
                            text: 'Please use YYYY-MM-DD.',
                        });
                        return;
                    }
        
                    // Check if dates exceed the current date
                    if (startDate > new Date(today) || endDate > new Date(today)) {
                        event.preventDefault();
                        Swal.fire({
                            icon: 'error',
                            title: 'Invalid Date',
                            text: 'Dates cannot exceed the current date.',
                        });
                        return;
                    }
        
                    // Check if start date is after end date
                    if (startDate > endDate) {
                        event.preventDefault();
                        Swal.fire({
                            icon: 'error',
                            title: 'Invalid Date Range',
                            text: 'Start date cannot be after the end date.',
                        });
                        return;
                    }
                });
            });
        </script>

       
</body>
</html>
